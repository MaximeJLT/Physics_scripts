clear all; close all; clc;

N = 1000; %nombre de simulations
X_1 = 0;
Y_1 = 0;
T = 1000; %nombre de pas
deltaX = 1;
deltaY = 1;
N_S = 4; %Nombre de simulations pour l'affichage en temps reel
d = 2; %Dimension du probleme

X = zeros(T, N);
Y = zeros(T, N); %matrices allant de t=1 a t=T

directions = randi(4, T, N); %même probabilité d'aller dans 4 directions, génère une matrice T x N d'entiers entre 1 et 4

% Créer une figure pour l'affichage en temps réel
figure;
hold on;

% Tracer l'origine
plot(0, 0, 'ko', 'MarkerSize', 8, 'MarkerFaceColor', 'k'); % Origine
xlabel('X'); ylabel('Y');
title('Marche Aléatoire 2D');
grid on; axis equal;

% Initialisation de la couleur pour chaque marcheur
colors = rand(N, 3); % Générer une couleur aléatoire pour chaque marcheur

% Tracer les trajectoires en temps réel
for t = 2:T   %On utilise 2 car t=1 est déjà utilisé pour 0,0
    X(t, :) = X(t-1, :);
    Y(t, :) = Y(t-1, :); %On initialise à la position précédente
    
    % Mise à jour de la position selon la direction
    X(t, directions(t, :) == 1) = X(t, directions(t, :) == 1) + deltaX;
    X(t, directions(t, :) == 2) = X(t, directions(t, :) == 2) - deltaX;
    Y(t, directions(t, :) == 3) = Y(t, directions(t, :) == 3) + deltaY;
    Y(t, directions(t, :) == 4) = Y(t, directions(t, :) == 4) - deltaY; %On va selon 4 directions possibles

    % Affichage des trajectoires des marcheurs au fur et à mesure
    for i = 1:N_S
        plot(X(1:t, i), Y(1:t, i), 'LineWidth', 1, 'Color', colors(i, :)); 
    end
    
    % Pause pour rendre l'animation visible
    pause(0.0001); % 0.01 secondes de pause entre chaque étape
end

% Affichage final des trajectoires
for i = 1:N_S
    plot(X(:, i), Y(:, i), 'LineWidth', 1, 'Color', colors(i, :));
    plot(X(end, i), Y(end, i), 'o', 'MarkerFaceColor', colors(i, :), 'MarkerEdgeColor', colors(i, :), 'MarkerSize', 8);
end

% Distribution de D(T)
D = sqrt(X(T, :).^2 + Y(T, :).^2); %On prend la distance au carre car la moyenne de la distance est nul car on a la meme proba dans les quatres directions

[H, edges] = histcounts(D, [1:100]);
figure(2);
bar(edges(1:end-1), H);
xlabel('Distance parcourue par le marcheur apres un temps T');
ylabel('Probabilité');hold on;
